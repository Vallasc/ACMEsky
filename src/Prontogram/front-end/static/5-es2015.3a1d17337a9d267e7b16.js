(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{jcJX:function(e,r,i){"use strict";i.r(r),i.d(r,"AccountModule",(function(){return q}));var n=i("3Pt+"),o=i("ofXK"),s=i("tyNb"),t=i("J9tS"),b=i("fXoL");let a=(()=>{class e{constructor(e,r){this.router=e,this.accountService=r,this.accountService.userValue&&this.router.navigate(["/"])}}return e.\u0275fac=function(r){return new(r||e)(b.Kb(s.c),b.Kb(t.a))},e.\u0275cmp=b.Eb({type:e,selectors:[["ng-component"]],decls:2,vars:0,consts:[[1,"col-md-6","offset-md-3","mt-5"]],template:function(e,r){1&e&&(b.Nb(0,"div",0),b.Lb(1,"router-outlet"),b.Mb())},directives:[s.g],encapsulation:2}),e})();var c=i("SxV6"),d=i("nPby"),u=i("Jho9");function l(e,r){1&e&&(b.Nb(0,"div"),b.jc(1,"Username obbligatorio"),b.Mb())}function m(e,r){if(1&e&&(b.Nb(0,"div",14),b.ic(1,l,2,0,"div",15),b.Mb()),2&e){const e=b.Wb();b.zb(1),b.Zb("ngIf",e.f.username.errors.required)}}function f(e,r){1&e&&(b.Nb(0,"div"),b.jc(1,"Password obbligatoria"),b.Mb())}function g(e,r){if(1&e&&(b.Nb(0,"div",14),b.ic(1,f,2,0,"div",15),b.Mb()),2&e){const e=b.Wb();b.zb(1),b.Zb("ngIf",e.f.password.errors.required)}}function p(e,r){1&e&&b.Lb(0,"span",16)}const h=function(e){return{"is-invalid":e}};function v(e,r){1&e&&(b.Nb(0,"div"),b.jc(1,"Nome obbligatorio"),b.Mb())}function N(e,r){if(1&e&&(b.Nb(0,"div",18),b.ic(1,v,2,0,"div",19),b.Mb()),2&e){const e=b.Wb();b.zb(1),b.Zb("ngIf",e.f.name.errors.required)}}function M(e,r){1&e&&(b.Nb(0,"div"),b.jc(1,"Cognome obbligatorio"),b.Mb())}function w(e,r){if(1&e&&(b.Nb(0,"div",18),b.ic(1,M,2,0,"div",19),b.Mb()),2&e){const e=b.Wb();b.zb(1),b.Zb("ngIf",e.f.secondName.errors.required)}}function S(e,r){1&e&&(b.Nb(0,"div"),b.jc(1,"Username is required"),b.Mb())}function I(e,r){1&e&&(b.Nb(0,"div"),b.jc(1,"L'username deve essere almeno di 6 caratteri"),b.Mb())}function j(e,r){if(1&e&&(b.Nb(0,"div",18),b.ic(1,S,2,0,"div",19),b.ic(2,I,2,0,"div",19),b.Mb()),2&e){const e=b.Wb();b.zb(1),b.Zb("ngIf",e.f.username.errors.required),b.zb(1),b.Zb("ngIf",e.f.username.errors.minlength)}}function Z(e,r){1&e&&(b.Nb(0,"div"),b.jc(1,"Password is required"),b.Mb())}function z(e,r){1&e&&(b.Nb(0,"div"),b.jc(1,"La password deve essere almeno di 6 caratteri"),b.Mb())}function y(e,r){if(1&e&&(b.Nb(0,"div",18),b.ic(1,Z,2,0,"div",19),b.ic(2,z,2,0,"div",19),b.Mb()),2&e){const e=b.Wb();b.zb(1),b.Zb("ngIf",e.f.password.errors.required),b.zb(1),b.Zb("ngIf",e.f.password.errors.minlength)}}function C(e,r){1&e&&b.Lb(0,"span",20)}const L=function(e){return{"is-invalid":e}},P=[{path:"",component:a,children:[{path:"login",component:(()=>{class e{constructor(e,r,i,n,o,s,t){this.formBuilder=e,this.route=r,this.router=i,this.accountService=n,this.alertService=o,this.notificationService=s,this.swPush=t,this.loading=!1,this.submitted=!1,this.VAPID_PUBLIC_KEY="BA161ZnkX9G6CwYOZifUyGpOxslxcANly0PfMtti7y1rDO9NZlPNI1yepdaTodQXX0gVHqXHVApmArL1MUNsBoM";let b=new d.e;b.name="riccardo",b.password="riccardo",b.secondName="baratin",b.username="riccardo",this.accountService.register(b).subscribe(e=>console.log(e),e=>console.log(e));let a=new d.e;a.name="giacomo",a.password="giacomo",a.secondName="vallorani",a.username="giacomo",this.accountService.register(a).subscribe(e=>console.log(e),e=>console.log(e));let c=new d.e;c.name="andrea",c.password="andrea",c.secondName="di ubaldo",c.username="andrea",this.accountService.register(c).subscribe(e=>console.log(e),e=>console.log(e))}ngOnInit(){this.form=this.formBuilder.group({username:["",n.h.required],password:["",n.h.required]})}get f(){return this.form.controls}onSubmit(){this.submitted=!0,this.alertService.clear(),this.form.invalid||(this.loading=!0,this.accountService.login(this.f.username.value,this.f.password.value).pipe(Object(c.a)()).subscribe({next:()=>{this.router.navigateByUrl(this.route.snapshot.queryParams.returnUrl||"/"),this.pushSubscription(this.f.username.value)},error:e=>{this.alertService.error("Username e/o password errati"),this.loading=!1}}))}pushSubscription(e){this.swPush.isEnabled?this.swPush.requestSubscription({serverPublicKey:this.VAPID_PUBLIC_KEY}).then(r=>{this.notificationService.sendSubscriptionToTheServer(r,e).subscribe(e=>console.log(e),e=>console.log(e))}).catch(e=>console.error("Could not subscribe to notifications",e)):console.log("swPush not enable")}}return e.\u0275fac=function(r){return new(r||e)(b.Kb(n.b),b.Kb(s.a),b.Kb(s.c),b.Kb(t.a),b.Kb(t.b),b.Kb(t.c),b.Kb(u.b))},e.\u0275cmp=b.Eb({type:e,selectors:[["ng-component"]],decls:23,vars:11,consts:[["align","center"],[1,"card"],[1,"card-header"],[1,"card-body"],[3,"formGroup","ngSubmit"],[1,"form-group"],["for","username"],["type","text","formControlName","username",1,"form-control",3,"ngClass"],["class","invalid-feedback",4,"ngIf"],["for","password"],["type","password","formControlName","password",1,"form-control",3,"ngClass"],[1,"btn","btn-primary",3,"disabled"],["class","spinner-border spinner-border-sm mr-1",4,"ngIf"],["routerLink","../register",1,"btn","btn-link"],[1,"invalid-feedback"],[4,"ngIf"],[1,"spinner-border","spinner-border-sm","mr-1"]],template:function(e,r){1&e&&(b.Nb(0,"h4",0),b.jc(1,"Benvenuto in Prontogram!"),b.Mb(),b.Nb(2,"div",1),b.Nb(3,"h4",2),b.jc(4,"Login"),b.Mb(),b.Nb(5,"div",3),b.Nb(6,"form",4),b.Ub("ngSubmit",(function(){return r.onSubmit()})),b.Nb(7,"div",5),b.Nb(8,"label",6),b.jc(9,"Username"),b.Mb(),b.Lb(10,"input",7),b.ic(11,m,2,1,"div",8),b.Mb(),b.Nb(12,"div",5),b.Nb(13,"label",9),b.jc(14,"Password"),b.Mb(),b.Lb(15,"input",10),b.ic(16,g,2,1,"div",8),b.Mb(),b.Nb(17,"div",5),b.Nb(18,"button",11),b.ic(19,p,1,0,"span",12),b.jc(20," Login "),b.Mb(),b.Nb(21,"a",13),b.jc(22,"Registrati"),b.Mb(),b.Mb(),b.Mb(),b.Mb(),b.Mb()),2&e&&(b.zb(6),b.Zb("formGroup",r.form),b.zb(4),b.Zb("ngClass",b.cc(7,h,r.submitted&&r.f.username.errors)),b.zb(1),b.Zb("ngIf",r.submitted&&r.f.username.errors),b.zb(4),b.Zb("ngClass",b.cc(9,h,r.submitted&&r.f.password.errors)),b.zb(1),b.Zb("ngIf",r.submitted&&r.f.password.errors),b.zb(2),b.Zb("disabled",r.loading),b.zb(1),b.Zb("ngIf",r.loading))},directives:[n.i,n.f,n.d,n.a,n.e,n.c,o.h,o.j,s.e],encapsulation:2}),e})()},{path:"register",component:(()=>{class e{constructor(e,r,i,n,o){this.formBuilder=e,this.route=r,this.router=i,this.accountService=n,this.alertService=o,this.loading=!1,this.submitted=!1}ngOnInit(){this.form=this.formBuilder.group({name:["",n.h.required],secondName:["",n.h.required],username:["",[n.h.required,n.h.minLength(6)]],password:["",[n.h.required,n.h.minLength(6)]]})}get f(){return this.form.controls}onSubmit(){this.submitted=!0,this.alertService.clear(),this.form.invalid||(this.loading=!0,this.accountService.register(this.form.value).pipe(Object(c.a)()).subscribe({next:()=>{this.alertService.success("Ti sei registrato con successo!",{keepAfterRouteChange:!0}),this.router.navigate(["../login"],{relativeTo:this.route})},error:()=>{this.alertService.error("Username gi\xe0 esistente"),this.loading=!1}}))}}return e.\u0275fac=function(r){return new(r||e)(b.Kb(n.b),b.Kb(s.a),b.Kb(s.c),b.Kb(t.a),b.Kb(t.b))},e.\u0275cmp=b.Eb({type:e,selectors:[["ng-component"]],decls:33,vars:19,consts:[["align","center"],[1,"card"],[1,"card-header"],[1,"card-body"],[3,"formGroup","ngSubmit"],[1,"form-group"],["for","nome"],["type","text","formControlName","name",1,"form-control",3,"ngClass"],["class","invalid-feedback",4,"ngIf"],["for","cognome"],["type","text","formControlName","secondName",1,"form-control",3,"ngClass"],["for","username"],["type","text","formControlName","username",1,"form-control",3,"ngClass"],["for","password"],["type","password","formControlName","password",1,"form-control",3,"ngClass"],[1,"btn","btn-primary",3,"disabled"],["class","spinner-border spinner-border-sm mr-1",4,"ngIf"],["routerLink","../login",1,"btn","btn-link"],[1,"invalid-feedback"],[4,"ngIf"],[1,"spinner-border","spinner-border-sm","mr-1"]],template:function(e,r){1&e&&(b.Nb(0,"h4",0),b.jc(1,"Effettua la registazione per accedere a Prontogram!"),b.Mb(),b.Nb(2,"div",1),b.Nb(3,"h4",2),b.jc(4,"Registazione"),b.Mb(),b.Nb(5,"div",3),b.Nb(6,"form",4),b.Ub("ngSubmit",(function(){return r.onSubmit()})),b.Nb(7,"div",5),b.Nb(8,"label",6),b.jc(9,"Nome"),b.Mb(),b.Lb(10,"input",7),b.ic(11,N,2,1,"div",8),b.Mb(),b.Nb(12,"div",5),b.Nb(13,"label",9),b.jc(14,"Cognome"),b.Mb(),b.Lb(15,"input",10),b.ic(16,w,2,1,"div",8),b.Mb(),b.Nb(17,"div",5),b.Nb(18,"label",11),b.jc(19,"Username"),b.Mb(),b.Lb(20,"input",12),b.ic(21,j,3,2,"div",8),b.Mb(),b.Nb(22,"div",5),b.Nb(23,"label",13),b.jc(24,"Password"),b.Mb(),b.Lb(25,"input",14),b.ic(26,y,3,2,"div",8),b.Mb(),b.Nb(27,"div",5),b.Nb(28,"button",15),b.ic(29,C,1,0,"span",16),b.jc(30," Registrati "),b.Mb(),b.Nb(31,"a",17),b.jc(32,"Torna alla pagina di login"),b.Mb(),b.Mb(),b.Mb(),b.Mb(),b.Mb()),2&e&&(b.zb(6),b.Zb("formGroup",r.form),b.zb(4),b.Zb("ngClass",b.cc(11,L,r.submitted&&r.f.name.errors)),b.zb(1),b.Zb("ngIf",r.submitted&&r.f.name.errors),b.zb(4),b.Zb("ngClass",b.cc(13,L,r.submitted&&r.f.secondName.errors)),b.zb(1),b.Zb("ngIf",r.submitted&&r.f.secondName.errors),b.zb(4),b.Zb("ngClass",b.cc(15,L,r.submitted&&r.f.username.errors)),b.zb(1),b.Zb("ngIf",r.submitted&&r.f.username.errors),b.zb(4),b.Zb("ngClass",b.cc(17,L,r.submitted&&r.f.password.errors)),b.zb(1),b.Zb("ngIf",r.submitted&&r.f.password.errors),b.zb(2),b.Zb("disabled",r.loading),b.zb(1),b.Zb("ngIf",r.loading))},directives:[n.i,n.f,n.d,n.a,n.e,n.c,o.h,o.j,s.e],encapsulation:2}),e})()}]}];let K=(()=>{class e{}return e.\u0275mod=b.Ib({type:e}),e.\u0275inj=b.Hb({factory:function(r){return new(r||e)},imports:[[s.f.forChild(P)],s.f]}),e})(),q=(()=>{class e{}return e.\u0275mod=b.Ib({type:e}),e.\u0275inj=b.Hb({factory:function(r){return new(r||e)},imports:[[o.b,n.g,K]]}),e})()}}]);